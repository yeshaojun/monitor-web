import{d as I,r as M,a as P,c as q,b as E,e,w as t,f as y,u,g as V,F as J,o as m,h as i,i as K,E as O}from"./index-1bb4ca13.js";import{v as _,L as k,u as p,E as R,a as S}from"./http-49163270.js";import{E as A,a as G,b as H}from"./el-table-column-eb0a58e0.js";import{E as Q,a as W}from"./el-form-item-bc1937a2.js";const X={install(d){d.directive("loading",_),d.config.globalProperties.$loading=k},directive:_,service:k},Y={class:"mb-5"},Z={class:"dialog-footer"},le=I({__name:"project",setup(d){const C=K(),s=M(!1),l=P({name:"",desc:""}),{isFetching:w,data:x,execute:f}=p("project/list").get(),{isFetching:F,data:h,execute:j}=p("project/create",{immediate:!1}).post(l),B=async c=>{const a=X.service({fullscreen:!0,text:"数据删除中"}),{data:n}=await p(`project/${c}`).delete();n&&(a.close(),f())};function $(){s.value=!0,l.name="",l.desc=""}async function L(){await j(),h&&(O.success("创建成功！"),s.value=!1,f())}function N(c){C.push({path:"/error",query:{id:c}})}return(c,a)=>{const n=R,r=H,D=A,v=S,g=Q,T=W,U=G,b=_;return m(),q(J,null,[E("div",Y,[e(n,{type:"primary",onClick:$},{default:t(()=>[i("新增")]),_:1})]),y((m(),V(D,{stripe:"",data:JSON.parse(u(x)),style:{width:"100%"}},{default:t(()=>[e(r,{prop:"_id",label:"apiKey"}),e(r,{prop:"name",label:"项目名称"}),e(r,{prop:"desc",label:"描述"}),e(r,{prop:"created_at",label:"创建时间"}),e(r,{label:"操作"},{default:t(o=>[e(n,{type:"primary",size:"small",onClick:z=>N(o.row._id)},{default:t(()=>[i("查看日志")]),_:2},1032,["onClick"]),e(n,{link:"",type:"primary",size:"small",onClick:z=>B(o.row._id)},{default:t(()=>[i("移除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[b,u(w)]]),e(U,{modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=o=>s.value=o),title:"新增项目",width:"30%"},{footer:t(()=>[E("span",Z,[e(n,{onClick:a[2]||(a[2]=o=>s.value=!1)},{default:t(()=>[i("取消")]),_:1}),y((m(),V(n,{type:"primary",onClick:L},{default:t(()=>[i(" 创建 ")]),_:1})),[[b,u(F)]])])]),default:t(()=>[e(T,{form:l},{default:t(()=>[e(g,{label:"项目名称"},{default:t(()=>[e(v,{modelValue:l.name,"onUpdate:modelValue":a[0]||(a[0]=o=>l.name=o)},null,8,["modelValue"])]),_:1}),e(g,{label:"项目描述"},{default:t(()=>[e(v,{modelValue:l.desc,"onUpdate:modelValue":a[1]||(a[1]=o=>l.desc=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["form"])]),_:1},8,["modelValue"])],64)}}});export{le as default};
